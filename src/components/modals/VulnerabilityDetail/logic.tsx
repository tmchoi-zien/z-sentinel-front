"use client";
import { getVuln } from "@/api";
import { VulnDetailType } from "@/types/api";
import { useQueries } from "react-query";

interface Props {
  cveName: string;
}

export default function VulnerabilityDetailLogic({ cveName }: Props) {
  const queries = useQueries([
    {
      queryKey: [`vuln-detail`, cveName],
      queryFn: () =>
        getVuln({
          name: cveName,
        }),
      suspense: true,
    },
  ]);

  const isLoading = queries.some((item) => item.data === undefined);
  const dtoData = isLoading
    ? undefined
    : (queries[0]?.data.data[0] as VulnDetailType);

  return dtoData;
}
